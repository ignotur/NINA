	subroutine neclumpN(x,y,z,necN,FcN,hitclump)
c returns electron density necN and fluctuation parameter FcN 
c at position designated by l,b,d,x,y,z c for a set of  
c clumps with parameters read in from file  neclumpN.dat

c input:
c	x,y,z	coordinates	(kpc)  (as in TC93)
c
c output:
c	necN	electron density in clump at (x,y,z)
c	FcN	fluctuation parameter
c 	hitclump = 0:   no clump hit
c		   j>0: j-th clump hit

	implicit none
	real x,y,z,necN,FcN
	integer hitclump

	integer nclumpsmax
	parameter (nclumpsmax=2000)

c	character*15 losname(nclumpsmax)
c	character*1 type(nclumpsmax)
	real lc(nclumpsmax), bc(nclumpsmax), dc(nclumpsmax)
        real xc(nclumpsmax), yc(nclumpsmax), zc(nclumpsmax)
        real nec(nclumpsmax), rc(nclumpsmax), Fc(nclumpsmax)
        integer edge(nclumpsmax)
	integer nclumps
	integer hitclumpflag
	common /clumps/ nclumps, hitclumpflag(nclumpsmax)

c parameters:
c	lc	= galactic longitude of clump center
c	bc	= galactic latitude of clump center
c	(xc,yc,zc) = clump center location (calculated)
c       nec	= internal peak electron density
c	rc	= clump radius at 1/e
c       Fc      = clump fluctuation parameter
c	edge    = 0 => use exponential rolloff out to 5rc
c                 1 => uniform and truncated at 1/e


	real radian
	parameter(radian = 57.29577951)

	real rsun
	parameter (rsun=8.5)

	logical first
c	data first/.true./

	real slc, clc, sbc, cbc
	real rgalc


	real arg

c	integer luclump
c	data luclump/11/
	integer j
	integer clumpflag
        integer just_for_fun
	save


	data first/.true./
c	data luclump/11/


c first time through, read input clump parameters and calculate
c LOS quantities. 
c lc,bc = Galactic coordinates (deg)
c   nec = clump electron density (cm^{-3})
c    Fc = fluctuation parameter
c    dc = clump distance from Earth (kpc)
c    rc = clump radius (kpc)
c  edge = 0,1  0=> Gaussian, 1=> Gaussian w/ hard edge at e^{-1} 
c  type = LOS type (P pulsar, G other Galactic, X extragalactic
c losname = useful name
        if(first) then         
         j=1
c	  write(6,*) 'reading neclumpN.NE2001.dat'
c	  open(luclump, file='neclumpN.NE2001.dat', status='old')
c	  read(luclump,*)				! label line
c    5     read(luclump,*,end=99) clumpflag,lc(j),bc(j),nec(j),Fc(j),
c          
c
c     .           dc(j),rc(j),edge(j)

5       just_for_fun=0


           lc(1) = -175.64
           bc(1) = -3.32
           nec(1) = 0.23
           Fc(1) = 0
           dc(1) = 0.63
           rc(1) = 0.01
           edge(1) = 0
           lc(2) = -175.44
           bc(2) = -5.78
           nec(2) = 0.03
           Fc(2) = 70
           dc(2) = 0.64
           rc(2) = 0.01
           edge(2) = 0
           lc(3) = -171.21
           bc(3) = 2.4
           nec(3) = 1.31
           Fc(3) = 0
           dc(3) = 0.65
           rc(3) = 0.01
           edge(3) = 0
           lc(4) = -171.18
           bc(4) = 6.22
           nec(4) = 0.41
           Fc(4) = 0
           dc(4) = 0.65
           rc(4) = 0.01
           edge(4) = 0
           lc(5) = -163.04
           bc(5) = 31.742
           nec(5) = 0.7
           Fc(5) = 0.01
           dc(5) = 0.19
           rc(5) = 0.01
           edge(5) = 0
           lc(6) = -146.3
           bc(6) = -12.6
           nec(6) = 0.33
           Fc(6) = 20
           dc(6) = 0.41
           rc(6) = 0.01
           edge(6) = 0
           lc(7) = -138.01
           bc(7) = 21.25
           nec(7) = 0.14
           Fc(7) = 0
           dc(7) = 0.55
           rc(7) = 0.01
           edge(7) = 0
           lc(8) = -129.78
           bc(8) = -80.25
           nec(8) = 0.51
           Fc(8) = 0
           dc(8) = 0.53
           rc(8) = 0.01
           edge(8) = 0
           lc(9) = -124.11
           bc(9) = 12.6
           nec(9) = 0.01
           Fc(9) = 100
           dc(9) = 1
           rc(9) = 0.01
           edge(9) = 0
           lc(10) = -123.05
           bc(10) = -16.76
           nec(10) = 0.53
           Fc(10) = 0
           dc(10) = 0.91
           rc(10) = 0.01
           edge(10) = 0
           lc(11) = -118.09
           bc(11) = 69.19
           nec(11) = 0.01
           Fc(11) = 20
           dc(11) = 0.17
           rc(11) = 0.01
           edge(11) = 0
           lc(12) = -106.61
           bc(12) = -41.96
           nec(12) = 0.055
           Fc(12) = 0.6
           dc(12) = 0.1
           rc(12) = 0.01
           edge(12) = 0
           lc(13) = -100
           bc(13) = -1
           nec(13) = 0.43
           Fc(13) = 0
           dc(13) = 0.5
           rc(13) = 0.145
           edge(13) = 1
           lc(14) = -97.2
           bc(14) = 2.7
           nec(14) = 0.5
           Fc(14) = 2
           dc(14) = 0.5
           rc(14) = 0.032
           edge(14) = 1
           lc(15) = -96.75
           bc(15) = -9
           nec(15) = 4
           Fc(15) = 3
           dc(15) = 0.25
           rc(15) = 0.038
           edge(15) = 1
           lc(16) = -79.77
           bc(16) = 0.084
           nec(16) = 0.4
           Fc(16) = 20
           dc(16) = 2.5
           rc(16) = 0.01
           edge(16) = 0
           lc(17) = -76.29
           bc(17) = -2.14
           nec(17) = 0.31
           Fc(17) = 100
           dc(17) = 4.39
           rc(17) = 0.01
           edge(17) = 0
           lc(18) = -76.2
           bc(18) = -0.68
           nec(18) = 40
           Fc(18) = 5
           dc(18) = 4.215
           rc(18) = 0.01
           edge(18) = 0
           lc(19) = -75.7
           bc(19) = -0.83
           nec(19) = 20
           Fc(19) = 20
           dc(19) = 4.215
           rc(19) = 0.01
           edge(19) = 0
           lc(20) = -74.02
           bc(20) = 6.65
           nec(20) = 0.85
           Fc(20) = 0
           dc(20) = 0.52
           rc(20) = 0.01
           edge(20) = 0
           lc(21) = -73.12
           bc(21) = -2.88
           nec(21) = 1
           Fc(21) = 1
           dc(21) = 3
           rc(21) = 0.02
           edge(21) = 0
           lc(22) = -69.708
           bc(22) = -2.966
           nec(22) = 5
           Fc(22) = 0.15
           dc(22) = 2.2
           rc(22) = 0.02
           edge(22) = 0
           lc(23) = -69.69
           bc(23) = -35.91
           nec(23) = 0.39
           Fc(23) = 0
           dc(23) = 0.47
           rc(23) = 0.01
           edge(23) = 0
           lc(24) = -68.56
           bc(24) = -0.32
           nec(24) = 0.56
           Fc(24) = 100
           dc(24) = 6.13
           rc(24) = 0.01
           edge(24) = 0
           lc(25) = -67.85
           bc(25) = -0.54
           nec(25) = 1
           Fc(25) = 1
           dc(25) = 2.3
           rc(25) = 0.02
           edge(25) = 0
           lc(26) = -66.51
           bc(26) = -0.97
           nec(26) = 1
           Fc(26) = 20
           dc(26) = 2.3
           rc(26) = 0.02
           edge(26) = 0
           lc(27) = -65.79
           bc(27) = -1.3
           nec(27) = 0.61
           Fc(27) = 100
           dc(27) = 6.51
           rc(27) = 0.01
           edge(27) = 0
           lc(28) = -62.91
           bc(28) = 6.47
           nec(28) = 0.03
           Fc(28) = 100
           dc(28) = 2.46
           rc(28) = 0.01
           edge(28) = 0
           lc(29) = -62.69
           bc(29) = -0.79
           nec(29) = 2.2
           Fc(29) = 1
           dc(29) = 2
           rc(29) = 0.02
           edge(29) = 0
           lc(30) = -61.08
           bc(30) = 0.2
           nec(30) = 3
           Fc(30) = 1
           dc(30) = 2.1
           rc(30) = 0.02
           edge(30) = 0
           lc(31) = -55.54
           bc(31) = -3.46
           nec(31) = 0.41
           Fc(31) = 100
           dc(31) = 6.58
           rc(31) = 0.01
           edge(31) = 0
           lc(32) = -55.5
           bc(32) = -0.12
           nec(32) = 20
           Fc(32) = 20
           dc(32) = 8
           rc(32) = 0.01
           edge(32) = 0
           lc(33) = -53.69
           bc(33) = 1.74
           nec(33) = 0.26
           Fc(33) = 100
           dc(33) = 2.03
           rc(33) = 0.01
           edge(33) = 0
           lc(34) = -53.1
           bc(34) = 0.85
           nec(34) = 20
           Fc(34) = 20
           dc(34) = 8
           rc(34) = 0.01
           edge(34) = 0
           lc(35) = -52.93
           bc(35) = 0.2
           nec(35) = 0.26
           Fc(35) = 100
           dc(35) = 1.99
           rc(35) = 0.01
           edge(35) = 0
           lc(36) = -52.5
           bc(36) = 3.56
           nec(36) = 0.36
           Fc(36) = 100
           dc(36) = 1.98
           rc(36) = 0.01
           edge(36) = 0
           lc(37) = -51.63
           bc(37) = 0.3
           nec(37) = 0.76
           Fc(37) = 100
           dc(37) = 6.5
           rc(37) = 0.01
           edge(37) = 0
           lc(38) = -51.27
           bc(38) = -0.04
           nec(38) = 0.71
           Fc(38) = 100
           dc(38) = 7.21
           rc(38) = 0.01
           edge(38) = 0
           lc(39) = -48.7
           bc(39) = 75.41
           nec(39) = 0.2
           Fc(39) = 0
           dc(39) = 0.29
           rc(39) = 0.01
           edge(39) = 0
           lc(40) = -47.35
           bc(40) = -5.4
           nec(40) = 1.87
           Fc(40) = 0
           dc(40) = 0.9
           rc(40) = 0.01
           edge(40) = 0
           lc(41) = -39.23
           bc(41) = -0.11
           nec(41) = 5
           Fc(41) = 0
           dc(41) = 3
           rc(41) = 0.01
           edge(41) = 0
           lc(42) = -39.07
           bc(42) = 20.45
           nec(42) = 1.47
           Fc(42) = 0
           dc(42) = 0.3
           rc(42) = 0.01
           edge(42) = 0
           lc(43) = -38.37
           bc(43) = -1.22
           nec(43) = 0.41
           Fc(43) = 100
           dc(43) = 1.6
           rc(43) = 0.01
           edge(43) = 0
           lc(44) = -38.13
           bc(44) = -35
           nec(44) = 0.41
           Fc(44) = 0
           dc(44) = 0.34
           rc(44) = 0.01
           edge(44) = 0
           lc(45) = -32.73
           bc(45) = 1.32
           nec(45) = 0.6
           Fc(45) = 0
           dc(45) = 1.5
           rc(45) = 0.01
           edge(45) = 0
           lc(46) = -30.27
           bc(46) = -0.48
           nec(46) = 0.9
           Fc(46) = 0
           dc(46) = 1.2
           rc(46) = 0.01
           edge(46) = 0
           lc(47) = -29.31
           bc(47) = 1.63
           nec(47) = 0.31
           Fc(47) = 100
           dc(47) = 3.62
           rc(47) = 0.01
           edge(47) = 0
           lc(48) = -29.28
           bc(48) = 22.56
           nec(48) = 0.3
           Fc(48) = 0
           dc(48) = 0.3
           rc(48) = 0.01
           edge(48) = 0
           lc(49) = -24.99
           bc(49) = -5.17
           nec(49) = 0.07
           Fc(49) = 100
           dc(49) = 1.48
           rc(49) = 0.01
           edge(49) = 0
           lc(50) = -24.75
           bc(50) = 7.98
           nec(50) = 0.09
           Fc(50) = 100
           dc(50) = 1.49
           rc(50) = 0.01
           edge(50) = 0
           lc(51) = -23.52
           bc(51) = 0.62
           nec(51) = 1.91
           Fc(51) = 100
           dc(51) = 3.43
           rc(51) = 0.01
           edge(51) = 0
           lc(52) = -21.27
           bc(52) = 1.98
           nec(52) = 0.61
           Fc(52) = 100
           dc(52) = 3.38
           rc(52) = 0.01
           edge(52) = 0
           lc(53) = -20.807
           bc(53) = -0.195
           nec(53) = 1.5
           Fc(53) = 4
           dc(53) = 3.4
           rc(53) = 0.02
           edge(53) = 0
           lc(54) = -18.89
           bc(54) = 0.97
           nec(54) = 0.61
           Fc(54) = 100
           dc(54) = 3.34
           rc(54) = 0.01
           edge(54) = 0
           lc(55) = -18.64
           bc(55) = -2.18
           nec(55) = 0.36
           Fc(55) = 100
           dc(55) = 3.33
           rc(55) = 0.01
           edge(55) = 0
           lc(56) = -15
           bc(56) = -10.18
           nec(56) = 0.01
           Fc(56) = 70
           dc(56) = 0.27
           rc(56) = 0.01
           edge(56) = 0
           lc(57) = -14.28
           bc(57) = -0.2
           nec(57) = 0.86
           Fc(57) = 100
           dc(57) = 1.45
           rc(57) = 0.01
           edge(57) = 0
           lc(58) = -14.12
           bc(58) = 3.27
           nec(58) = 0.36
           Fc(58) = 100
           dc(58) = 1.46
           rc(58) = 0.01
           edge(58) = 0
           lc(59) = -12.35
           bc(59) = -1.53
           nec(59) = 0.31
           Fc(59) = 100
           dc(59) = 1.46
           rc(59) = 0.01
           edge(59) = 0
           lc(60) = -12.02
           bc(60) = -4.46
           nec(60) = 0.13
           Fc(60) = 100
           dc(60) = 1.46
           rc(60) = 0.01
           edge(60) = 0
           lc(61) = -9.31
           bc(61) = 4.07
           nec(61) = 0.15
           Fc(61) = 100
           dc(61) = 1.47
           rc(61) = 0.01
           edge(61) = 0
           lc(62) = -9.07
           bc(62) = -0
           nec(62) = 4.06
           Fc(62) = 0
           dc(62) = 1.5
           rc(62) = 0.01
           edge(62) = 0
           lc(63) = -8.8
           bc(63) = 0.646
           nec(63) = 10
           Fc(63) = 1280
           dc(63) = 1.67
           rc(63) = 0.008
           edge(63) = 0
           lc(64) = -7.88
           bc(64) = 2.02
           nec(64) = 0.36
           Fc(64) = 100
           dc(64) = 5.47
           rc(64) = 0.01
           edge(64) = 0
           lc(65) = -6.7
           bc(65) = -1.54
           nec(65) = 10
           Fc(65) = 18000
           dc(65) = 8.4
           rc(65) = 0.05
           edge(65) = 0
           lc(66) = -5.87
           bc(66) = 0.09
           nec(66) = 1.21
           Fc(66) = 100
           dc(66) = 1.48
           rc(66) = 0.01
           edge(66) = 0
           lc(67) = -5.44
           bc(67) = 2.52
           nec(67) = 0.11
           Fc(67) = 100
           dc(67) = 1.44
           rc(67) = 0.01
           edge(67) = 0
           lc(68) = -4.72
           bc(68) = -4.11
           nec(68) = 0.17
           Fc(68) = 100
           dc(68) = 1.49
           rc(68) = 0.01
           edge(68) = 0
           lc(69) = -4.23
           bc(69) = -1.748
           nec(69) = 10
           Fc(69) = 23100
           dc(69) = 8.4
           rc(69) = 0.05
           edge(69) = 0
           lc(70) = -2.9
           bc(70) = -0.22
           nec(70) = 0.96
           Fc(70) = 100
           dc(70) = 3.31
           rc(70) = 0.01
           edge(70) = 0
           lc(71) = -2.15
           bc(71) = 9.74
           nec(71) = 10
           Fc(71) = 4500
           dc(71) = 8.4
           rc(71) = 0.05
           edge(71) = 0
           lc(72) = -2.14
           bc(72) = -0.997
           nec(72) = 5
           Fc(72) = 20
           dc(72) = 8.5
           rc(72) = 0.01
           edge(72) = 0
           lc(73) = -1.45
           bc(73) = -0.96
           nec(73) = 0.05
           Fc(73) = 100
           dc(73) = 1.43
           rc(73) = 0.01
           edge(73) = 0
           lc(74) = -0.86
           bc(74) = 1.14
           nec(74) = 10
           Fc(74) = 80000
           dc(74) = 8.4
           rc(74) = 0.05
           edge(74) = 0
           lc(75) = -0.54
           bc(75) = -1.24
           nec(75) = 4.36
           Fc(75) = 0
           dc(75) = 2
           rc(75) = 0.01
           edge(75) = 0
           lc(76) = -0.44
           bc(76) = 1.29
           nec(76) = 10
           Fc(76) = 500
           dc(76) = 8.4
           rc(76) = 0.05
           edge(76) = 0
           lc(77) = 0.12
           bc(77) = 5.111
           nec(77) = 10
           Fc(77) = 320
           dc(77) = 8.4
           rc(77) = 0.05
           edge(77) = 0
           lc(78) = 0.57
           bc(78) = 36.61
           nec(78) = 0.52
           Fc(78) = 0
           dc(78) = 0.34
           rc(78) = 0.01
           edge(78) = 0
           lc(79) = 0.89
           bc(79) = 1.342
           nec(79) = 10
           Fc(79) = 720
           dc(79) = 8.4
           rc(79) = 0.05
           edge(79) = 1
           lc(80) = 2.66
           bc(80) = -49.46
           nec(80) = 0.01
           Fc(80) = 25
           dc(80) = 0.14
           rc(80) = 0.01
           edge(80) = 0
           lc(81) = 3.84
           bc(81) = -3.26
           nec(81) = 3.96
           Fc(81) = 0
           dc(81) = 1.5
           rc(81) = 0.01
           edge(81) = 0
           lc(82) = 5.77
           bc(82) = 13.66
           nec(82) = 0.3
           Fc(82) = 0
           dc(82) = 0.29
           rc(82) = 0.01
           edge(82) = 0
           lc(83) = 6.81
           bc(83) = -0.08
           nec(83) = 1.01
           Fc(83) = 100
           dc(83) = 6.63
           rc(83) = 0.01
           edge(83) = 0
           lc(84) = 10.72
           bc(84) = 35.47
           nec(84) = 0.2
           Fc(84) = 0
           dc(84) = 0.27
           rc(84) = 0.01
           edge(84) = 0
           lc(85) = 10.93
           bc(85) = -45.44
           nec(85) = 0.04
           Fc(85) = 0
           dc(85) = 0.14
           rc(85) = 0.01
           edge(85) = 0
           lc(86) = 14.11
           bc(86) = 26.06
           nec(86) = 0.67
           Fc(86) = 0
           dc(86) = 0.34
           rc(86) = 0.01
           edge(86) = 0
           lc(87) = 14.6
           bc(87) = -3.42
           nec(87) = 0.21
           Fc(87) = 100
           dc(87) = 1.74
           rc(87) = 0.01
           edge(87) = 0
           lc(88) = 15.25
           bc(88) = -23.39
           nec(88) = 0.38
           Fc(88) = 0
           dc(88) = 0.34
           rc(88) = 0.01
           edge(88) = 0
           lc(89) = 16.41
           bc(89) = 0.61
           nec(89) = 0.66
           Fc(89) = 100
           dc(89) = 4.83
           rc(89) = 0.01
           edge(89) = 0
           lc(90) = 17.25
           bc(90) = -0.176
           nec(90) = 17
           Fc(90) = 0
           dc(90) = 3.5
           rc(90) = 0.01
           edge(90) = 0
           lc(91) = 17.81
           bc(91) = 45.77
           nec(91) = 0.2
           Fc(91) = 0.7
           dc(91) = 0.46
           rc(91) = 0.01
           edge(91) = 0
           lc(92) = 20.06
           bc(92) = 5.59
           nec(92) = 0.07
           Fc(92) = 95
           dc(92) = 1.69
           rc(92) = 0.01
           edge(92) = 0
           lc(93) = 20.07
           bc(93) = -0.09
           nec(93) = 10
           Fc(93) = 725
           dc(93) = 4
           rc(93) = 0.01
           edge(93) = 0
           lc(94) = 20.63
           bc(94) = 38.16
           nec(94) = 0.4
           Fc(94) = 0
           dc(94) = 0.86
           rc(94) = 0.01
           edge(94) = 0
           lc(95) = 21.29
           bc(95) = 0.8
           nec(95) = 0.86
           Fc(95) = 100
           dc(95) = 1.92
           rc(95) = 0.01
           edge(95) = 0
           lc(96) = 21.45
           bc(96) = 1.32
           nec(96) = 0.012
           Fc(96) = 85
           dc(96) = 0.34
           rc(96) = 0.01
           edge(96) = 1
           lc(97) = 22.26
           bc(97) = -1.42
           nec(97) = 2.66
           Fc(97) = 0
           dc(97) = 2
           rc(97) = 0.01
           edge(97) = 0
           lc(98) = 23.39
           bc(98) = 0.063
           nec(98) = 8
           Fc(98) = 0
           dc(98) = 4.4
           rc(98) = 0.01
           edge(98) = 0
           lc(99) = 25.09
           bc(99) = 0.55
           nec(99) = 2.06
           Fc(99) = 100
           dc(99) = 2.06
           rc(99) = 0.01
           edge(99) = 0
           lc(100) = 25.46
           bc(100) = 4.733
           nec(100) = 0.5
           Fc(100) = 2
           dc(100) = 1.5
           rc(100) = 0.02
           edge(100) = 0
           lc(101) = 27.17
           bc(101) = 1.13
           nec(101) = 0.31
           Fc(101) = 100
           dc(101) = 2.17
           rc(101) = 0.01
           edge(101) = 0
           lc(102) = 28.05
           bc(102) = 5.31
           nec(102) = 0.09
           Fc(102) = 100
           dc(102) = 2.17
           rc(102) = 0.01
           edge(102) = 0
           lc(103) = 28.35
           bc(103) = 0.17
           nec(103) = 0.89
           Fc(103) = 100
           dc(103) = 2.23
           rc(103) = 0.01
           edge(103) = 0
           lc(104) = 28.49
           bc(104) = -5.68
           nec(104) = 0.11
           Fc(104) = 100
           dc(104) = 2.25
           rc(104) = 0.01
           edge(104) = 0
           lc(105) = 30.51
           bc(105) = -33.08
           nec(105) = 0.12
           Fc(105) = 0
           dc(105) = 0.32
           rc(105) = 0.01
           edge(105) = 0
           lc(106) = 31.31
           bc(106) = -7.12
           nec(106) = 0.05
           Fc(106) = 100
           dc(106) = 1.78
           rc(106) = 0.01
           edge(106) = 0
           lc(107) = 31.34
           bc(107) = 0.039
           nec(107) = 0.12
           Fc(107) = 200
           dc(107) = 2.4
           rc(107) = 0.02
           edge(107) = 0
           lc(108) = 33.3
           bc(108) = 0.1
           nec(108) = 10
           Fc(108) = 200
           dc(108) = 7.4
           rc(108) = 0.02
           edge(108) = 0
           lc(109) = 33.69
           bc(109) = -3.55
           nec(109) = 0.06
           Fc(109) = 100
           dc(109) = 2.62
           rc(109) = 0.01
           edge(109) = 0
           lc(110) = 34.1
           bc(110) = -20.3
           nec(110) = 0.39
           Fc(110) = 0
           dc(110) = 0.46
           rc(110) = 0.01
           edge(110) = 0
           lc(111) = 34.99
           bc(111) = 8.86
           nec(111) = 1.27
           Fc(111) = 0
           dc(111) = 0.44
           rc(111) = 0.01
           edge(111) = 0
           lc(112) = 35.2
           bc(112) = -1.73
           nec(112) = 2
           Fc(112) = 10
           dc(112) = 2.8
           rc(112) = 0.01
           edge(112) = 0
           lc(113) = 35.727
           bc(113) = -1.955
           nec(113) = 2
           Fc(113) = 0.4
           dc(113) = 2.8
           rc(113) = 0.04
           edge(113) = 0
           lc(114) = 37.08
           bc(114) = 21.68
           nec(114) = 1.09
           Fc(114) = 0
           dc(114) = 0.49
           rc(114) = 0.01
           edge(114) = 0
           lc(115) = 40.08
           bc(115) = 6.28
           nec(115) = 0.49
           Fc(115) = 0
           dc(115) = 0.51
           rc(115) = 0.01
           edge(115) = 0
           lc(116) = 40.569
           bc(116) = 1.056
           nec(116) = 1
           Fc(116) = 1
           dc(116) = 3.5
           rc(116) = 0.02
           edge(116) = 0
           lc(117) = 40.62
           bc(117) = -0.14
           nec(117) = 10
           Fc(117) = 12500
           dc(117) = 2.2
           rc(117) = 0.003
           edge(117) = 0
           lc(118) = 41.91
           bc(118) = 0.087
           nec(118) = 6
           Fc(118) = 20
           dc(118) = 8
           rc(118) = 0.01
           edge(118) = 0
           lc(119) = 42.29
           bc(119) = 3.06
           nec(119) = 0.01
           Fc(119) = 25
           dc(119) = 0.55
           rc(119) = 0.01
           edge(119) = 0
           lc(120) = 43.16
           bc(120) = 0.01
           nec(120) = 3.5
           Fc(120) = 20
           dc(120) = 8.5
           rc(120) = 0.02
           edge(120) = 0
           lc(121) = 43.48
           bc(121) = 54.49
           nec(121) = 0.38
           Fc(121) = 0
           dc(121) = 0.34
           rc(121) = 0.01
           edge(121) = 0
           lc(122) = 43.78
           bc(122) = -0.135
           nec(122) = 6
           Fc(122) = 20
           dc(122) = 2.6
           rc(122) = 0.02
           edge(122) = 0
           lc(123) = 44.83
           bc(123) = 0.99
           nec(123) = 1.95
           Fc(123) = 0
           dc(123) = 0.6
           rc(123) = 0.01
           edge(123) = 0
           lc(124) = 47.58
           bc(124) = 0.45
           nec(124) = 5.01
           Fc(124) = 0
           dc(124) = 4
           rc(124) = 0.01
           edge(124) = 0
           lc(125) = 49.4
           bc(125) = -70.19
           nec(125) = 0.01
           Fc(125) = 35
           dc(125) = 0.2
           rc(125) = 0.01
           edge(125) = 0
           lc(126) = 51.88
           bc(126) = -2.46
           nec(126) = 0.11
           Fc(126) = 100
           dc(126) = 3.77
           rc(126) = 0.01
           edge(126) = 0
           lc(127) = 53.72
           bc(127) = -1.31
           nec(127) = 0.16
           Fc(127) = 100
           dc(127) = 4.43
           rc(127) = 0.01
           edge(127) = 0
           lc(128) = 55.28
           bc(128) = 2.93
           nec(128) = 0.06
           Fc(128) = 100
           dc(128) = 1.3
           rc(128) = 0.01
           edge(128) = 0
           lc(129) = 55.33
           bc(129) = -3.5
           nec(129) = 0.01
           Fc(129) = 25
           dc(129) = 0.7
           rc(129) = 0.01
           edge(129) = 0
           lc(130) = 55.57
           bc(130) = 0.64
           nec(130) = 0.11
           Fc(130) = 100
           dc(130) = 1.39
           rc(130) = 0.01
           edge(130) = 0
           lc(131) = 55.61
           bc(131) = -3
           nec(131) = 0.16
           Fc(131) = 100
           dc(131) = 5.12
           rc(131) = 0.01
           edge(131) = 0
           lc(132) = 55.78
           bc(132) = 3.5
           nec(132) = 0.01
           Fc(132) = 25
           dc(132) = 0.56
           rc(132) = 0.01
           edge(132) = 0
           lc(133) = 61.11
           bc(133) = -16.84
           nec(133) = 0.01
           Fc(133) = 100
           dc(133) = 1.21
           rc(133) = 0.01
           edge(133) = 0
           lc(134) = 62.32
           bc(134) = 0.59
           nec(134) = 0.23
           Fc(134) = 100
           dc(134) = 2.46
           rc(134) = 0.01
           edge(134) = 0
           lc(135) = 65.01
           bc(135) = -27.31
           nec(135) = 0.789
           Fc(135) = 0
           dc(135) = 2
           rc(135) = 0.01
           edge(135) = 0
           lc(136) = 65.92
           bc(136) = 0.77
           nec(136) = 0.01
           Fc(136) = 10
           dc(136) = 0.36
           rc(136) = 0.01
           edge(136) = 0
           lc(137) = 68.1
           bc(137) = -3.98
           nec(137) = 0.01
           Fc(137) = 30
           dc(137) = 0.62
           rc(137) = 0.01
           edge(137) = 0
           lc(138) = 68.77
           bc(138) = 2.82
           nec(138) = 0.03
           Fc(138) = 30
           dc(138) = 1.58
           rc(138) = 0.01
           edge(138) = 0
           lc(139) = 69.01
           bc(139) = 0.02
           nec(139) = 0.06
           Fc(139) = 100
           dc(139) = 2.41
           rc(139) = 0.01
           edge(139) = 0
           lc(140) = 70.7
           bc(140) = 5.05
           nec(140) = 0.13
           Fc(140) = 100
           dc(140) = 2.38
           rc(140) = 0.01
           edge(140) = 0
           lc(141) = 70.95
           bc(141) = 14.2
           nec(141) = 0.01
           Fc(141) = 25
           dc(141) = 1.11
           rc(141) = 0.01
           edge(141) = 0
           lc(142) = 71.16
           bc(142) = -0.088
           nec(142) = 1.5
           Fc(142) = 20
           dc(142) = 2.35
           rc(142) = 0.01
           edge(142) = 0
           lc(143) = 71.4
           bc(143) = -3.1
           nec(143) = 0.35
           Fc(143) = 20
           dc(143) = 2.35
           rc(143) = 0.01
           edge(143) = 0
           lc(144) = 73.1
           bc(144) = -2.4
           nec(144) = 0.8
           Fc(144) = 20
           dc(144) = 2.35
           rc(144) = 0.01
           edge(144) = 0
           lc(145) = 74.04
           bc(145) = 0.356
           nec(145) = 0.9
           Fc(145) = 20
           dc(145) = 2.35
           rc(145) = 0.01
           edge(145) = 0
           lc(146) = 74.14
           bc(146) = -1.01
           nec(146) = 2.2
           Fc(146) = 20
           dc(146) = 2.35
           rc(146) = 0.01
           edge(146) = 0
           lc(147) = 74.18
           bc(147) = 2.61
           nec(147) = 1.9
           Fc(147) = 20
           dc(147) = 2.35
           rc(147) = 0.01
           edge(147) = 0
           lc(148) = 74.6
           bc(148) = -8.04
           nec(148) = 0.9
           Fc(148) = 20
           dc(148) = 2.35
           rc(148) = 0.01
           edge(148) = 0
           lc(149) = 74.9
           bc(149) = 1.2
           nec(149) = 0.6
           Fc(149) = 20
           dc(149) = 2.2
           rc(149) = 0.01
           edge(149) = 0
           lc(150) = 75.78
           bc(150) = 2.19
           nec(150) = 0.95
           Fc(150) = 20
           dc(150) = 2.35
           rc(150) = 0.01
           edge(150) = 0
           lc(151) = 76.8
           bc(151) = 4.3
           nec(151) = 1
           Fc(151) = 20
           dc(151) = 2.35
           rc(151) = 0.01
           edge(151) = 0
           lc(152) = 78.9
           bc(152) = -5.1
           nec(152) = 0.1
           Fc(152) = 20
           dc(152) = 2.35
           rc(152) = 0.02
           edge(152) = 0
           lc(153) = 79.13
           bc(153) = -5.59
           nec(153) = 0.07
           Fc(153) = 100
           dc(153) = 2.11
           rc(153) = 0.01
           edge(153) = 0
           lc(154) = 79.85
           bc(154) = 0.699
           nec(154) = 3.5
           Fc(154) = 20
           dc(154) = 2.35
           rc(154) = 0.02
           edge(154) = 0
           lc(155) = 81.8
           bc(155) = 0.637
           nec(155) = 3.5
           Fc(155) = 20
           dc(155) = 2.4
           rc(155) = 0.02
           edge(155) = 0
           lc(156) = 83.87
           bc(156) = -64.08
           nec(156) = 0.12
           Fc(156) = 0
           dc(156) = 0.46
           rc(156) = 0.01
           edge(156) = 0
           lc(157) = 85.43
           bc(157) = 2.11
           nec(157) = 10
           Fc(157) = 20
           dc(157) = 2
           rc(157) = 0.01
           edge(157) = 0
           lc(158) = 86.08
           bc(158) = 23.82
           nec(158) = 0.01
           Fc(158) = 40
           dc(158) = 0.84
           rc(158) = 0.01
           edge(158) = 0
           lc(159) = 86.14
           bc(159) = -21.73
           nec(159) = 0.5
           Fc(159) = 1
           dc(159) = 2
           rc(159) = 0.02
           edge(159) = 0
           lc(160) = 89
           bc(160) = -1.27
           nec(160) = 0.85
           Fc(160) = 0
           dc(160) = 1.59
           rc(160) = 0.01
           edge(160) = 0
           lc(161) = 90.37
           bc(161) = 7.308
           nec(161) = 5
           Fc(161) = 20
           dc(161) = 2
           rc(161) = 0.01
           edge(161) = 0
           lc(162) = 90.49
           bc(162) = -11.34
           nec(162) = 0.01
           Fc(162) = 100
           dc(162) = 1.56
           rc(162) = 0.01
           edge(162) = 0
           lc(163) = 91.33
           bc(163) = 52.29
           nec(163) = 0.01
           Fc(163) = 100
           dc(163) = 0.49
           rc(163) = 0.01
           edge(163) = 0
           lc(164) = 91.36
           bc(164) = -42.36
           nec(164) = 0.42
           Fc(164) = 0
           dc(164) = 0.58
           rc(164) = 0.01
           edge(164) = 0
           lc(165) = 95.83
           bc(165) = -36.07
           nec(165) = 0.28
           Fc(165) = 0
           dc(165) = 0.57
           rc(165) = 0.01
           edge(165) = 0
           lc(166) = 97.72
           bc(166) = -26.66
           nec(166) = 0.01
           Fc(166) = 100
           dc(166) = 1.42
           rc(166) = 0.01
           edge(166) = 0
           lc(167) = 98.38
           bc(167) = -7.6
           nec(167) = 0.23
           Fc(167) = 0
           dc(167) = 1.17
           rc(167) = 0.01
           edge(167) = 0
           lc(168) = 108.64
           bc(168) = 6.84
           nec(168) = 0.01
           Fc(168) = 60
           dc(168) = 0.94
           rc(168) = 0.01
           edge(168) = 0
           lc(169) = 109.87
           bc(169) = 2.102
           nec(169) = 0.6
           Fc(169) = 20
           dc(169) = 0.6
           rc(169) = 0.02
           edge(169) = 0
           lc(170) = 110.42
           bc(170) = -69.81
           nec(170) = 0.14
           Fc(170) = 0
           dc(170) = 0.24
           rc(170) = 0.01
           edge(170) = 0
           lc(171) = 111.54
           bc(171) = 0.774
           nec(171) = 0.5
           Fc(171) = 20
           dc(171) = 3.4
           rc(171) = 0.02
           edge(171) = 0
           lc(172) = 133.95
           bc(172) = 1.058
           nec(172) = 10
           Fc(172) = 320
           dc(172) = 2.2
           rc(172) = 0.02
           edge(172) = 0
           lc(173) = 135.7
           bc(173) = 2.4
           nec(173) = 0.9
           Fc(173) = 20
           dc(173) = 2.2
           rc(173) = 0.01
           edge(173) = 0
           lc(174) = 145
           bc(174) = -1.22
           nec(174) = 0.19
           Fc(174) = 0
           dc(174) = 0.54
           rc(174) = 0.01
           edge(174) = 0
           lc(175) = 148.19
           bc(175) = 0.81
           nec(175) = 0.91
           Fc(175) = 0
           dc(175) = 0.63
           rc(175) = 0.01
           edge(175) = 0



        if(j .le. 175) then
           clumpflag=0
         else
           clumpflag=1
           go to 99
         endif




          if(clumpflag .eq. 0) then
	    slc = sin(lc(j)/radian)
	    clc = cos(lc(j)/radian)
	    sbc = sin(bc(j)/radian)
	    cbc = cos(bc(j)/radian)
	    rgalc = dc(j)*cbc
	    xc(j) = rgalc*slc
	    yc(j) = rsun-rgalc*clc
	    zc(j) = dc(j)*sbc
c	  write(6,"(a15,1x,8(f8.3,1x))") 
c    .           losname(j),lc(j),bc(j),dc(j),
c    .           nec(j),Fc(j),xc(j),yc(j),zc(j)
	    j=j+1
	  endif
	  go to 5
   99     continue
	  first = .false.
	  nclumps = j-1
c	  close(luclump)
	endif

	necN = 0.
	hitclump = 0
	FcN = 0.
	do j=1,nclumps
	  arg = 
     .      ((x-xc(j))**2 + (y-yc(j))**2 + (z-zc(j))**2) / rc(j)**2
	  if(edge(j) .eq. 0 .and. arg .lt. 5.) then
	    necN = necN + nec(j) * exp(-arg)
            FcN = Fc(j)
	    hitclump = j
            hitclumpflag(j) = 1
	  endif
	  if(edge(j) .eq. 1 .and. arg .le. 1.) then
c    	    necN = necN + nec(j) * exp(-arg)
	    necN = necN + nec(j)
            FcN = Fc(j)
	    hitclump = j
            hitclumpflag(j) = 1
	  endif
	enddo
	

	return
	end




